<#
    .SYNOPSIS
        Imports Dashboard templates to tenable.ad.

    .DESCRIPTION
        This script can import built-in dashboard templates to tenable.ad. 
        Alternatively a DashboardsPath can be specified to import external folder of templates as well. 
        Works with both on-prem and SaaS versions.

    .PARAMETER Server
        Required. The host name or IP address of the security engine node, or the SaaS public IP.

    .PARAMETER Protocol
        Optional. The protocol to be used. Can be http or https(default).

    .PARAMETER APIKey
        The API Key for the tenable.ad user that you'd like dashboards imported to.

    .PARAMETER DashboardsPath
        Optional. The folder path containing templates to import instead of importing the built-in ones within this script.

    .PARAMETER RemoveExisting
        Optional. When used, all existing dashboards except the default one are removed before import

    .EXAMPLE
        PS> .\Import-Dashboards.ps1 -Server "customer.tenable.ad" -APIKey "a9ffa061-f7db-45cd-b729-fd9c031976aa"
        Imports embedded Built-in dashboard templates to Server https://customer.tenable.ad.

        PS> .\Import-Dashboards.ps1 -Server "192.168.10.50" -APIKey "a9ffa061-f7db-45cd-b729-fd9c031976aa"
        Imports embedded Built-in dashboard templates to Security Engine Node https://192.168.10.50.

    .EXAMPLE
        PS> .\Import-Dashboards.ps1 -Server "customer.tenable.ad" -APIKey "a9ffa061-f7db-45cd-b729-fd9c031976aa" -DashboardsPath "C:\test\"
        Imports all dashboard files (*.JSON) from the folder specified in DashboardsPath to Server https://customer.tenable.ad.

    .EXAMPLE
        PS> .\Import-Dashboards.ps1 -Server "customer.tenable.ad" -APIKey "a9ffa061-f7db-45cd-b729-fd9c031976aa" -DashboardsPath "C:\test\" -RemoveExisting
        Deletes existing dashboards, then imports all dashboard files (*.JSON) from the folder specified in DashboardsPath to Server https://customer.tenable.ad.

    .CREDITS
        Taher Karaki; @iTaher

    .VERSION
        1.2 - Removed base64 encoding to speed up operations.
            - Added 'RemoveExisting' parameter to remove existing dashboards before importing.
        1.1 - Added the ability to specify external folder path to import using 'DashboardsPath' parameter, or use the built-in ones if not specified.
        1.0 - Initial version

#>
[CmdletBinding(DefaultParametersetName = 'Import')]

Param (
    [Parameter(Mandatory = $True, ParameterSetName = 'Import', HelpMessage = "The computer name or IP address of the security engine node.")]
    [string]
    $server,

    [Parameter(Mandatory = $False, ParameterSetName = 'Import', HelpMessage = "(Optional) The protocol to be used. Can be http or https(default).")]
    [string]
    $protocol = "https",

    [Parameter(Mandatory = $True, ParameterSetName = 'Import', HelpMessage = "The API Key for the tenable.ad user that you'd like dashboards imported to.")]
    [string]
    $apikey,

    [Parameter(Mandatory = $False, ParameterSetName = 'Import', HelpMessage = "(Optional) The folder path containing templates to import instead of importing the built-in ones within this script.")]
    [string]
    $DashboardsPath,

    [Parameter(Mandatory = $False, ParameterSetName = 'Import', HelpMessage = "(Optional) Removes all dashboards before importing.")]
    [switch]
    $RemoveExisting=$False
)

# Built-in templates base64 encoded.
$templates=[System.Collections.ArrayList]@(
'{"id":91,"name":"AD CLEAN-UP","order":0,"widget":{"value":[{"id":1180,"posX":0,"posY":0,"height":2,"width":2,"title":"ALL USERS","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"type":"User","active":null,"duration":1296000,"interval":null},"displayOptions":{"label":"ALL USERS "}}]}},{"id":1181,"posX":2,"posY":0,"height":2,"width":2,"title":"ENABLED USERS","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"type":"User","active":true,"duration":1296000,"interval":null},"displayOptions":{"label":"ENABLED USERS"}}]}},{"id":1182,"posX":4,"posY":0,"height":2,"width":2,"title":"DISABLED USERS","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"type":"User","active":false,"duration":1296000,"interval":null},"displayOptions":{"label":"DISABLED USERS"}}]}},{"id":1183,"posX":0,"posY":2,"height":3,"width":2,"title":"AD USERS EVOLUTION","options":{"type":"BarChart","series":[{"dataOptions":{"type":"User","directoryIds":[1,2],"duration":2592000},"displayOptions":{"label":"ALL USERS"}},{"dataOptions":{"type":"User","directoryIds":[1,2],"active":true,"duration":2592000},"displayOptions":{"label":"ENABLED USERS"}},{"dataOptions":{"type":"User","directoryIds":[1,2],"active":false,"duration":2592000},"displayOptions":{"label":"DISABLED USERS"}}]}},{"id":1184,"posX":6,"posY":0,"height":2,"width":2,"title":"SLEEPING ACCOUNTS","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[5],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"SLEEPING ACCOUNTS"}}]}},{"id":1185,"posX":0,"posY":5,"height":3,"width":4,"title":"SLEEPING ACCOUNTS EVOLUTION - 1 Month","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[5],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"SLEEPING ACCOUNTS"}}]}},{"id":1186,"posX":4,"posY":5,"height":3,"width":4,"title":"DISABLED ACCOUNTS IN PRIVILEGED GROUPS","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[19],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"DISABLED ACCOUNTS IN PRIVILEGED GROUPS"}}]}},{"id":1187,"posX":6,"posY":2,"height":3,"width":2,"title":"DISABLED ACCOUNTS IN PRIVILEGED GROUPS","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[19],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"DISABLED ACCOUNTS IN PRIVILEGED GROUPS"}}]}},{"id":1188,"posX":2,"posY":2,"height":3,"width":4,"title":"AD CLEAN-UP IOE DEVIANCES","options":{"type":"BarChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[18],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Obsolete OS"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[5],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":" Sleeping accounts"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[24],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Domains have an outdated functional level"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Unlinked, disabled or orphan GPO"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[19],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Disabled accounts in privileged groups"}}]}}]}}',
'{"id":92,"name":"AD Top Issues","order":0,"widget":{"value":[{"id":1189,"posX":0,"posY":4,"height":4,"width":4,"title":"TOP PASSWORDS ISSUES","options":{"type":"BarChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[42],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Clear test password found"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[12],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Users with Reversible Password"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[29],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Weak passwords"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[33],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Users with old password"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[9],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"KDC Last Password change"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[11],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Reversible passwords in GPO"}}]}},{"id":1190,"posX":4,"posY":0,"height":4,"width":4,"title":"TOP PRIVILEGED ACCOUNT ISSUES","options":{"type":"BarChart","series":[{"dataOptions":{"type":"Deviance","checkerIds":[7],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Privileged accounts running services"}},{"dataOptions":{"type":"Deviance","checkerIds":[8],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Too many members in Privileged Groups"}},{"dataOptions":{"type":"Deviance","checkerIds":[9],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"KDC account last password change"}},{"dataOptions":{"type":"Deviance","checkerIds":[38],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Protected Users group not used"}},{"dataOptions":{"type":"Deviance","checkerIds":[6],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"AdminCount attribute on regular users"}},{"dataOptions":{"type":"Deviance","checkerIds":[15],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Administrator account usage"}},{"dataOptions":{"type":"Deviance","checkerIds":[23],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"LAPS usage disable"}},{"dataOptions":{"type":"Deviance","checkerIds":[19],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Disables acounts in privileged groups"}},{"dataOptions":{"type":"Deviance","checkerIds":[14],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Users with PrimaryGroupID dangerous value"}}]}},{"id":1320,"posX":0,"posY":0,"height":4,"width":4,"title":"Main AD attack paths","options":{"type":"BarChart","series":[{"dataOptions":{"type":"Deviance","checkerIds":[7],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Privileged accounts running kerberos services"}},{"dataOptions":{"type":"Deviance","checkerIds":[13],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Dangerous kerberos delegations"}},{"dataOptions":{"type":"Deviance","checkerIds":[30],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Domain controllers managed by illegitimate users"}},{"dataOptions":{"type":"Deviance","checkerIds":[14],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Dangerous Primary Group Id"}},{"dataOptions":{"type":"Deviance","checkerIds":[21],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Permissions allowing DCSync attacks"}},{"dataOptions":{"type":"Deviance","checkerIds":[48],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Dangerous Certificate Services misconfigurations"}}]}}]}}',
'{"id":93,"name":"CISO DASHBOARD","order":0,"widget":{"value":[{"id":1191,"posX":0,"posY":0,"height":3,"width":4,"title":"GLOBAL COMPLIANCE SCORE","options":{"type":"BarChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[7,8,10,13,14,16,21,28,29,30,32,40],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"CRITICAL COMPLIANCE SCORE"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[4,9,17,18,20,34,35,37,38,41,42],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"HIGH COMPLIANCE SCORE"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3,5,6,11,12,15,22,23,24,33,36,39],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"MEDIUM COMPLIANCE SCORE"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,19,26],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"LOW COMPLIANCE SCORE"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,28,29,30,32,33,34,35,36,37,38,39,40,41,42],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"GLOBAL COMPLIANCE SCORE"}}]}},{"id":1192,"posX":4,"posY":0,"height":3,"width":2,"title":"GLOBAL COMPLIANCE SCORE","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,28,29,30,32,33,34,35,36,37,38,39,40,41,42],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"COMPLIANCE SCORE"}}]}},{"id":1193,"posX":6,"posY":0,"height":3,"width":2,"title":"CRITICAL COMPLIANCE SCORE","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[7,8,10,13,14,16,21,28,29,30,32,40],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"CRITICAL "}}]}},{"id":1194,"posX":6,"posY":6,"height":2,"width":2,"title":"HIGH COMPLIANCE SCORE","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[4,9,17,18,20,34,35,37,38,41,42],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"HIGH COMPLIANCE SCORE"}}]}},{"id":1195,"posX":4,"posY":3,"height":3,"width":4,"title":"COMPLIANCE SCORE EVOUTION","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[7,8,10,13,14,16,21,28,29,30,32,40],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Critical IoE Compliance Score"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[4,9,17,18,20,34,35,37,38,41,42],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"High IoE Compliance Score"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3,5,6,11,12,15,22,23,24,33,36,39],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Medium IoE Compliance Score"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,19,26],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Low IoE Compliance Score"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,28,29,30,32,33,34,35,36,37,38,39,40,41,42],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Global IoE Compliance Score"}}]}},{"id":1196,"posX":0,"posY":3,"height":3,"width":4,"title":"QUICK WINS","options":{"type":"BarChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[10],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"  Ensure SDProp consistency"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[30],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Domain controllers managed by illegitimate users"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[21],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":" Root objects permissions allowing DCSync Attack"}}]}},{"id":1197,"posX":4,"posY":6,"height":2,"width":2,"title":"Ensure SDProp consistency","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[10],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Ensure SDProp consistency"}}]}},{"id":1198,"posX":2,"posY":6,"height":2,"width":2,"title":"Root objects permissions allowing DCSync-like atta","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[21],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Root objects permissions allowing DCSync Attack"}}]}},{"id":1199,"posX":0,"posY":6,"height":2,"width":2,"title":"Domain controllers managed by illegitimate users","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[30],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Domain controllers managed by illegitimate users"}}]}}]}}',
'{"id":94,"name":"COMPLIANCE SCORE","order":0,"widget":{"value":[{"id":1200,"posX":0,"posY":4,"height":5,"width":4,"title":"CRITICAL COMPLIANCE SCORE","options":{"type":"BarChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[7],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Privileged accounts running Kerberos services"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[8],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Native administrative group members"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[10],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Ensure SDProp consistency"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[13],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Dangerous delegation"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[14],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":" User Primary Group ID"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[16],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Use of weak cryptography algorithms into AD PKI"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[21],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Root objects permissions allowing DCSync Attack"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[28],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":" Verify sensitive GPO objects and files permission"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[29],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Weak password policies are applied on users"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[30],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Domain controllers managed by illegitimate users"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[32],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Verify permissions related to AAD Connect accounts"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[40],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":" Mapped certificates on accounts"}}]}},{"id":1201,"posX":4,"posY":9,"height":5,"width":4,"title":"LOW COMPLIANCE SCORE ","options":{"type":"BarChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Unlinked, disabled or orphan GPO"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[19],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Disabled accounts in privileged groups"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[26],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Domain using a dangerous backward-compatibility co"}}]}},{"id":1202,"posX":0,"posY":2,"height":2,"width":2,"title":"CRITICAL COMPLIANCE SCORE","options":{"type":"BigNumber","series":[{"dataOptions":{"type":"ComplianceScore","checkerIds":[7,8,10,13,14,16,21,28,29,30,32,40,45,48],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"C"}}]}},{"id":1203,"posX":2,"posY":2,"height":2,"width":2,"title":"HIGH COMPLIANCE SCORE","options":{"type":"BigNumber","series":[{"dataOptions":{"type":"ComplianceScore","checkerIds":[4,9,17,18,20,34,35,37,38,41,42,46,47],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Serie-1"}}]}},{"id":1204,"posX":6,"posY":2,"height":2,"width":2,"title":"LOW COMPLIANCE SCORE","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,19,26],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"LOW COMPLIANCE SCORE"}}]}},{"id":1205,"posX":4,"posY":4,"height":5,"width":4,"title":"HIGH COMPLIANCE SCORE ","options":{"type":"BarChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[4],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Dangerous trust relationship"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[9],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"KDC password last change"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[17],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Accounts having a dangerous SID History attribute"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[20],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Accounts using a pre-Windows 2000 compatible Acces"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[34],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Dangerous rights in AD schema"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[35],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Verify AAD SSO account password last change"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[37],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Account that might have an empty password"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[38],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Protected Users group not used"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[41],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Dangerous sensitive privileges"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[42],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Potential clear-text password"}}]}},{"id":1206,"posX":0,"posY":0,"height":2,"width":2,"title":"GLOBAL COMPLIANCE","options":{"type":"BarChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,28,29,30,32,33,34,35,36,37,38,39,40,41,42],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"GLOBAL"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[7,8,10,13,14,16,21,28,29,30,32,40],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"CRITICAL "}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[4,9,17,18,20,34,35,37,38,41,42],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"HIGH"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3,5,6,11,12,15,22,23,24,33,36,39],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"MEDIUM"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,19,26],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"LOW"}}]}},{"id":1207,"posX":2,"posY":0,"height":2,"width":2,"title":"GLOBAL COMPLIANCE SCORE","options":{"type":"BigNumber","series":[{"dataOptions":{"type":"ComplianceScore","checkerIds":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,26,28,29,30,32,33,34,35,36,37,38,39,40,41,42,23,44,45,46,47,48,49],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"GLOBAL "}}]}},{"id":1208,"posX":4,"posY":2,"height":2,"width":2,"title":"MEDIUM COMPLIANCE SCORE ","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3,5,6,11,12,15,22,24,33,36,39],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"MEDIUM COMPLIANCE SCORE"}}]}},{"id":1209,"posX":0,"posY":9,"height":5,"width":4,"title":"MEDIUM COMPLIANCE SCORE","options":{"type":"BarChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Accounts with never expiring passwords"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[5],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":" Sleeping accounts"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[6],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"AdminCount attribute set on standard users"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[11],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Reversible passwords in GPO"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[12],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Reversible passwords"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[15],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Recent use of the default administrator account"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[22],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":" Kerberos configuration on user account"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[24],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Domains have an outdated functional level"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[33],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"User account using old password"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[36],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Users allowed to join computers to the domain"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[39],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Domain without computer-hardening GPOs"}}]}},{"id":1210,"posX":6,"posY":0,"height":2,"width":2,"title":"Global Compliance score","options":{"type":"LineChart","series":[{"dataOptions":{"type":"ComplianceScore","checkerIds":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,28,29,30,32,33,34,35,36,37,38,39,40,41,42,44,45,46,47,48],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":2592000},"displayOptions":{"label":"Global Compliance score evolution"}}]}},{"id":1211,"posX":4,"posY":0,"height":2,"width":2,"title":"Compliance Score trend","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[7,8,10,13,14,16,21,28,29,30,32,40],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Critical"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[4,9,17,18,20,34,35,37,38,41,42],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"High"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3,5,6,11,12,15,22,23,24,33,36,39],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Medium"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,19,26],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Low"}}]}}]}}',
'{"id":96,"name":"PASSWORD POLICY COMPLIANCE","order":0,"widget":{"value":[{"id":1292,"posX":0,"posY":0,"height":5,"width":5,"title":"PASSWORD RELATED IOE - COMPLIANCE SCORE","options":{"type":"BarChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[29],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Weak password policies are applied on users"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[9],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"KDC password last change"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[35],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Verify AAD SSO account password last change"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[37],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Account that might have an empty password"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[42],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Potential clear-text password"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Accounts with never expiring passwords"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[11],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Reversible passwords in GPO"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[12],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Reversible passwords"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[23],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Local administrative account management"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[33],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"User account using old password"}}]}},{"id":1293,"posX":9,"posY":0,"height":5,"width":5,"title":"PASSWORD DEVIANCES ON USER ACCOUNT - EVOLUTION","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[37],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Account that might have an empty password"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Accounts with never expiring passwords"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[33],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"User account using old password"}}]}},{"id":1294,"posX":14,"posY":0,"height":5,"width":2,"title":"Potential Empty Passwords","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[37],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Account that might have an empty password"}}]}},{"id":1295,"posX":14,"posY":5,"height":2,"width":2,"title":"Accounts with never expiring passwords","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Accounts with never expiring passwords"}}]}},{"id":1296,"posX":14,"posY":7,"height":2,"width":2,"title":"User account using old password","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[33],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"User account using old password"}}]}},{"id":1297,"posX":9,"posY":8,"height":4,"width":5,"title":"PASSWORD DEVIANCES ON USER ACCOUNT","options":{"type":"BarChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[37],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Account that might have an empty password"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Accounts with never expiring passwords"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[33],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"User account using old password"}}]}},{"id":1298,"posX":0,"posY":5,"height":2,"width":5,"title":"REVERSIBLE PASSWORD DEVIANCES ","options":{"type":"BarChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[11],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Reversible passwords in GPO"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[12],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":" Reversible passwords"}}]}},{"id":1299,"posX":5,"posY":5,"height":2,"width":5,"title":"ITS TIME TO CHANGE PASSWORD - DEVIANCES","options":{"type":"BarChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[9],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"KDC password last change"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[35],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Verify AAD SSO account password last change"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[33],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":" User account using old password"}}]}},{"id":1300,"posX":5,"posY":0,"height":2,"width":4,"title":"PASSWORD BEST PRACTICES COMPLIANCE SCORE","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3,9,11,12,23,29,33,35,37,42],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"PASSWORD BEST PRACTICES COMPLIANCE SCORE"}}]}},{"id":1301,"posX":5,"posY":2,"height":3,"width":4,"title":"PASSWORD BEST PRACTICES COMPLIANCE EVOLUTION","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3,9,11,12,23,29,33,35,37,42],"reasonIds":[],"type":"ComplianceScore","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"PASSWORD BEST PRACTICES COMPLIANCE SCORE EVOLUTION"}}]}}]}}',
'{"id":97,"name":"REMEDIATION PLAN","order":0,"widget":{"value":[{"id":1302,"posX":0,"posY":0,"height":2,"width":2,"title":"CRITICAL DEVIANCES","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[7,8,10,13,14,16,21,28,29,30,31,32,40],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"CRITICAL DEVIANCES"}}]}},{"id":1303,"posX":0,"posY":2,"height":3,"width":2,"title":"DEVIANCES EVOLUTION >10K","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[29],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Weak password policies are applied on users"}}]}},{"id":1304,"posX":0,"posY":5,"height":2,"width":2,"title":"MEDIUM DEVIANCES ","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3,5,6,11,12,15,22,23,24,33,36,39],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"MEDIUM DEVIANCES "}}]}},{"id":1305,"posX":0,"posY":7,"height":3,"width":2,"title":"MEDIUM DEVIANCES EVOLUTION >10K","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[23],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Local administrative account management"}}]}},{"id":1306,"posX":2,"posY":0,"height":5,"width":2,"title":"CRITICAL DEVIANCES >100<10K","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[30],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Domain controllers with illegitimate users"}}]}},{"id":1307,"posX":2,"posY":5,"height":5,"width":2,"title":"MEDIUM DEVIANCES EVOLUTION >1K<10K","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Accounts with never expiring passwords"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[5],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Sleeping accounts"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[33],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":" User account using old password"}}]}},{"id":1308,"posX":4,"posY":0,"height":5,"width":4,"title":"CRITICAL EVOLUTION DEVIANCES <100","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[21],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Root objects permissions allowing DCSync-like atta"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[8],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Native administrative group members"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[7],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Privileged accounts running Kerberos services"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[10],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Ensure SDProp consistency"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[13],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Dangerous delegation"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[14],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"User Primary Group ID"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[16],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Use of weak cryptography algorithms into AD PKI"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[28],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Verify sensitive GPO objects and files permissions"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[32],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":" Verify permissions related to AAD Connect account"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[40],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Mapped certificates on accounts"}}]}},{"id":1309,"posX":4,"posY":5,"height":5,"width":4,"title":"MEDIUM DEVIANCES EVOLUTION <100","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[6],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"AdminCount attribute set on standard users"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[11],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Reversible passwords in GPO"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[12],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":" Reversible passwords"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[15],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Recent use of the default administrator account"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[22],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Kerberos configuration on user account"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[24],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Domains have an outdated functional level"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[36],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Users allowed to join computers to the domain"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[39],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":" Domain without computer-hardening GPOs"}}]}},{"id":1310,"posX":8,"posY":0,"height":2,"width":2,"title":"HIGH DEVIANCES","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[4,9,17,18,20,27,34,35,37,38,41,42],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"HIGH DEVIANCES"}}]}},{"id":1311,"posX":8,"posY":2,"height":3,"width":2,"title":"HIGH DEVIANCES EVOLUTION >1K","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[18],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Computers running an obsolete OS"}}]}},{"id":1312,"posX":8,"posY":5,"height":2,"width":2,"title":"LOW DEVIANCES","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,19,26],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"LOW DEVIANCES"}}]}},{"id":1313,"posX":10,"posY":0,"height":5,"width":2,"title":"HIGH DEVIANCES >100<1K","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[42],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Potential clear-text password"}}]}},{"id":1314,"posX":12,"posY":0,"height":5,"width":4,"title":"HIGH DEVIANCES EVOLUTION","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[4],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Dangerous trust relationship"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[9],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":" KDC password last change"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[17],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Accounts having a dangerous SID History attribute"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[20],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Accounts using a pre-Windows 2000 compatible acces"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[34],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Dangerous rights in AD schema"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[35],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Verify AAD SSO account password last change"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[37],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Account that might have an empty password"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[38],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Protected Users group not used"}},{"dataOptions":{"directoryIds":[1,2],"checkerIds":[41],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Dangerous sensitive privileges"}}]}}]}}',
'{"id":95,"name":"Deviance monitoring","order":0,"widget":{"value":[{"id":1212,"posX":0,"posY":0,"height":2,"width":2,"title":"Privileged accounts running Kerberos services","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[7],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Nb Privileged accounts running Kerberos services"}}]}},{"id":1213,"posX":2,"posY":0,"height":2,"width":2,"title":"Privileged accounts running Kerberos services","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[7],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Privileged accounts running Kerberos services"}}]}},{"id":1214,"posX":4,"posY":0,"height":2,"width":2,"title":"Native administrative group members","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[8],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Nb Native administrative group members"}}]}},{"id":1215,"posX":6,"posY":0,"height":2,"width":3,"title":"Native administrative group members","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[8],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Trend Native administrative group members"}}]}},{"id":1216,"posX":0,"posY":2,"height":2,"width":2,"title":"Ensure SDProp consistency","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[10],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Nb Ensure SDProp consistency"}}]}},{"id":1217,"posX":2,"posY":2,"height":2,"width":2,"title":"Ensure SDProp consistency","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[10],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Serie-1"}}]}},{"id":1218,"posX":4,"posY":2,"height":2,"width":2,"title":"User Primary Group ID","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[14],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Nb User Primary Group ID"}}]}},{"id":1219,"posX":6,"posY":2,"height":2,"width":3,"title":"User Primary Group ID","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[14],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"User Primary Group ID"}}]}},{"id":1220,"posX":0,"posY":4,"height":2,"width":2,"title":"Dangerous Kerberos delegation","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[13],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Nb Dangerous Kerberos delegation"}}]}},{"id":1221,"posX":2,"posY":4,"height":2,"width":2,"title":"Dangerous Kerberos delegation","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[13],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Dangerous Kerberos delegation"}}]}},{"id":1222,"posX":4,"posY":4,"height":2,"width":2,"title":"PKI Use of weak cryptography algorithms","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[16],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"PKI Use of weak cryptography algorithms "}}]}},{"id":1223,"posX":6,"posY":4,"height":2,"width":3,"title":"PKI Use of weak cryptography algorithms","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[16],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"PKI Use of weak cryptography algorithms"}}]}},{"id":1224,"posX":0,"posY":6,"height":2,"width":2,"title":"Dangerous Root objects permissions","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[21],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Dangerous Root objects permissions"}}]}},{"id":1225,"posX":2,"posY":6,"height":2,"width":2,"title":"Dangerous Root objects permissions","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[21],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Dangerous Root objects permissions"}}]}},{"id":1226,"posX":4,"posY":6,"height":2,"width":2,"title":"Verify sensitive GPO objects and files permissions","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[28],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Verify sensitive GPO objects and files permissions"}}]}},{"id":1227,"posX":6,"posY":6,"height":2,"width":3,"title":"Verify sensitive GPO objects and files permissions","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[28],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Verify sensitive GPO objects and files permissions"}}]}},{"id":1228,"posX":0,"posY":8,"height":2,"width":2,"title":"Weak password policies are applied on users","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[29],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Weak password policies are applied on users"}}]}},{"id":1229,"posX":2,"posY":8,"height":2,"width":2,"title":"Weak password policies are applied on users","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[29],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Weak password policies are applied on users"}}]}},{"id":1230,"posX":4,"posY":8,"height":2,"width":2,"title":"Domain controllers managed by illegitimate users","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[30],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Domain controllers managed by illegitimate users"}}]}},{"id":1231,"posX":6,"posY":8,"height":2,"width":3,"title":"Domain controllers managed by illegitimate users","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,28,29,30,32,33,34,35,36,37,38,39,40,41,42,44,45],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Domain controllers managed by illegitimate users"}}]}},{"id":1232,"posX":0,"posY":10,"height":2,"width":2,"title":"Permissions related to AAD Connect accounts","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[32],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Permissions related to AAD Connect accounts"}}]}},{"id":1233,"posX":2,"posY":10,"height":2,"width":2,"title":"Permissions related to AAD Connect accounts","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[32],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Permissions related to AAD Connect accounts"}}]}},{"id":1234,"posX":4,"posY":10,"height":2,"width":2,"title":"Mapped certificates on accounts","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[40],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Mapped certificates on accounts"}}]}},{"id":1235,"posX":6,"posY":10,"height":2,"width":3,"title":"Mapped certificates on accounts","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[40],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Mapped certificates on accounts"}}]}},{"id":1236,"posX":0,"posY":12,"height":2,"width":2,"title":"Unsecured configuration of Netlogon protocol","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[45],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Unsecured configuration of Netlogon protocol"}}]}},{"id":1237,"posX":2,"posY":12,"height":2,"width":2,"title":"Unsecured configuration of Netlogon protocol","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,28,29,30,32,33,34,35,36,37,38,39,40,41,42,44,45],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Unsecured configuration of Netlogon protocol"}}]}},{"id":1238,"posX":0,"posY":14,"height":2,"width":2,"title":"Dangerous trust relationship","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[4],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Dangerous trust relationship"}}]}},{"id":1239,"posX":2,"posY":14,"height":2,"width":2,"title":"Dangerous trust relationship","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[4],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Dangerous trust relationship"}}]}},{"id":1240,"posX":4,"posY":12,"height":2,"width":2,"title":"KDC password last change","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[9],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"KDC password last change"}}]}},{"id":1241,"posX":6,"posY":12,"height":2,"width":3,"title":"KDC password last change","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[9],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"KDC password last change"}}]}},{"id":1242,"posX":0,"posY":16,"height":2,"width":2,"title":"Accounts having a dangerous SID History attribute","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[17],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Accounts having a dangerous SID History attribute"}}]}},{"id":1243,"posX":2,"posY":16,"height":2,"width":2,"title":"Accounts having a dangerous SID History attribute","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[17],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Accounts having a dangerous SID History attribute"}}]}},{"id":1244,"posX":4,"posY":14,"height":2,"width":2,"title":"Computers running an obsolete OS","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[18],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Computers running an obsolete OS"}}]}},{"id":1245,"posX":6,"posY":14,"height":2,"width":3,"title":"Computers running an obsolete OS","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[18],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Computers running an obsolete OS"}}]}},{"id":1246,"posX":0,"posY":18,"height":2,"width":2,"title":"pre-Windows 2000 compatible access control","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[20],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"pre-Windows 2000 compatible access control"}}]}},{"id":1247,"posX":2,"posY":18,"height":2,"width":2,"title":"pre-Windows 2000 compatible access control","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[20],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"pre-Windows 2000 compatible access control"}}]}},{"id":1248,"posX":4,"posY":16,"height":2,"width":2,"title":"Dangerous rights in AD schema","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[34],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Dangerous rights in AD schema"}}]}},{"id":1249,"posX":6,"posY":16,"height":2,"width":3,"title":"Dangerous rights in AD schema","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[34],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Dangerous rights in AD schema"}}]}},{"id":1250,"posX":0,"posY":20,"height":2,"width":2,"title":"Verify AAD SSO account password","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[35],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Verify AAD SSO account password"}}]}},{"id":1251,"posX":2,"posY":20,"height":2,"width":2,"title":"Verify AAD SSO account password","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[35],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Verify AAD SSO account password"}}]}},{"id":1252,"posX":4,"posY":18,"height":2,"width":2,"title":"Account that might have an empty password","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[37],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Account that might have an empty password"}}]}},{"id":1253,"posX":6,"posY":18,"height":2,"width":3,"title":"Account that might have an empty password","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[37],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Account that might have an empty password"}}]}},{"id":1254,"posX":0,"posY":22,"height":2,"width":2,"title":"Protected Users group not used","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[38],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Protected Users group not used"}}]}},{"id":1255,"posX":2,"posY":22,"height":2,"width":2,"title":"Protected Users group not used","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[38],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Protected Users group not used"}}]}},{"id":1256,"posX":4,"posY":20,"height":2,"width":2,"title":"Dangerous sensitive privileges","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[41],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Dangerous sensitive privileges"}}]}},{"id":1257,"posX":6,"posY":20,"height":2,"width":3,"title":"Dangerous sensitive privileges","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[41],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Dangerous sensitive privileges"}}]}},{"id":1258,"posX":4,"posY":22,"height":2,"width":2,"title":"Potential clear-text password","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[42],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Potential clear-text password"}}]}},{"id":1259,"posX":6,"posY":22,"height":2,"width":3,"title":"Potential clear-text password","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[42],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Potential clear-text password"}}]}},{"id":1260,"posX":0,"posY":24,"height":2,"width":2,"title":"Accounts with never expiring passwords","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Accounts with never expiring passwords"}}]}},{"id":1261,"posX":2,"posY":24,"height":2,"width":2,"title":"Accounts with never expiring passwords","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[3],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Accounts with never expiring passwords"}}]}},{"id":1262,"posX":4,"posY":24,"height":2,"width":2,"title":"AdminCount attribute set on standard users","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[6],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"AdminCount attribute set on standard users"}}]}},{"id":1263,"posX":6,"posY":24,"height":2,"width":3,"title":"AdminCount attribute set on standard users","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[6],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"AdminCount attribute set on standard users"}}]}},{"id":1264,"posX":0,"posY":26,"height":2,"width":2,"title":"Sleeping accounts","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[5],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Sleeping accounts"}}]}},{"id":1265,"posX":2,"posY":26,"height":2,"width":2,"title":"Sleeping accounts","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,28,29,30,32,33,34,35,36,37,38,39,40,41,42,44,45],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Sleeping accounts"}}]}},{"id":1266,"posX":4,"posY":26,"height":2,"width":2,"title":"Reversible passwords in GPO","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[11],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Reversible passwords in GPO"}}]}},{"id":1267,"posX":6,"posY":26,"height":2,"width":3,"title":"Reversible passwords in GPO","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[12],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Reversible passwords in GPO"}}]}},{"id":1268,"posX":0,"posY":28,"height":2,"width":2,"title":"Reversible passwords","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[12],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Reversible passwords"}}]}},{"id":1269,"posX":2,"posY":28,"height":2,"width":2,"title":"Reversible passwords","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[12],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Reversible passwords"}}]}},{"id":1270,"posX":4,"posY":28,"height":2,"width":2,"title":"Recent use of the default administrator account","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[15],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Recent use of the default administrator account"}}]}},{"id":1271,"posX":6,"posY":28,"height":2,"width":3,"title":"Recent use of the default administrator account","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,28,29,30,32,33,34,35,36,37,38,39,40,41,42,44,45],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Recent use of the default administrator account"}}]}},{"id":1272,"posX":0,"posY":30,"height":2,"width":2,"title":"Kerberos configuration on user account","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[22],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Kerberos configuration on user account"}}]}},{"id":1273,"posX":2,"posY":30,"height":2,"width":2,"title":"Kerberos configuration on user account","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[22],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Kerberos configuration on user account"}}]}},{"id":1274,"posX":4,"posY":30,"height":2,"width":2,"title":"Local administrative account management","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[23],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Local administrative account management"}}]}},{"id":1275,"posX":6,"posY":30,"height":2,"width":3,"title":"Local administrative account management","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[23],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Local administrative account management"}}]}},{"id":1276,"posX":0,"posY":32,"height":2,"width":2,"title":"Domains have an outdated functional level","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[24],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Domains have an outdated functional level"}}]}},{"id":1277,"posX":2,"posY":32,"height":2,"width":2,"title":"Domains have an outdated functional level","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[24],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Domains have an outdated functional level"}}]}},{"id":1278,"posX":4,"posY":32,"height":2,"width":2,"title":"User account using old password","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[33],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"User account using old password"}}]}},{"id":1279,"posX":6,"posY":32,"height":2,"width":3,"title":"User account using old password","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[33],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"User account using old password"}}]}},{"id":1280,"posX":0,"posY":34,"height":2,"width":2,"title":"Users allowed to join computers to the domain","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[36],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Users allowed to join computers to the domain"}}]}},{"id":1281,"posX":2,"posY":34,"height":2,"width":2,"title":"Users allowed to join computers to the domain","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[36],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Users allowed to join computers to the domain"}}]}},{"id":1282,"posX":4,"posY":34,"height":2,"width":2,"title":"Domain without computer-hardening GPOs","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[39],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":" Domain without computer-hardening GPOs"}}]}},{"id":1283,"posX":6,"posY":34,"height":2,"width":3,"title":"Domain without computer-hardening GPOs","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[39],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":" Domain without computer-hardening GPOs"}}]}},{"id":1284,"posX":0,"posY":36,"height":2,"width":2,"title":"Unlinked, disabled or orphan GPO","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Unlinked, disabled or orphan GPO"}}]}},{"id":1285,"posX":2,"posY":36,"height":2,"width":2,"title":"Unlinked, disabled or orphan GPO","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[2],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Unlinked, disabled or orphan GPO"}}]}},{"id":1286,"posX":4,"posY":36,"height":2,"width":2,"title":"Disabled accounts in privileged groups","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[19],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":" Disabled accounts in privileged groups"}}]}},{"id":1287,"posX":6,"posY":36,"height":2,"width":3,"title":"Disabled accounts in privileged groups","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[19],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":" Disabled accounts in privileged groups"}}]}},{"id":1288,"posX":0,"posY":38,"height":2,"width":2,"title":"dangerous backward-compatibility","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[26],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"dangerous backward-compatibility"}}]}},{"id":1289,"posX":2,"posY":38,"height":2,"width":2,"title":"dangerous backward-compatibility","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[26],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"dangerous backward-compatibility"}}]}},{"id":1290,"posX":4,"posY":38,"height":2,"width":2,"title":"Vulnerable credential roaming related attribute","options":{"type":"BigNumber","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[44],"reasonIds":[],"type":"Deviance","profileId":1,"duration":1296000,"interval":null},"displayOptions":{"label":"Vulnerable credential roaming related attribute"}}]}},{"id":1291,"posX":6,"posY":38,"height":2,"width":3,"title":"Vulnerable credential roaming related attribute","options":{"type":"LineChart","series":[{"dataOptions":{"directoryIds":[1,2],"checkerIds":[44],"reasonIds":[],"type":"Deviance","profileId":1,"duration":2592000,"interval":null},"displayOptions":{"label":"Vulnerable credential roaming related attribute"}}]}}]}}',
'{"id":98,"name":"Summary","order":1,"widget":{"value":[{"id":1315,"posX":0,"posY":0,"height":2,"width":2,"title":"Active Users","options":{"type":"BigNumber","series":[{"dataOptions":{"duration":0,"active":true,"directoryIds":[1,2],"type":"User"},"displayOptions":{}}]}},{"id":1316,"posX":4,"posY":0,"height":4,"width":3,"title":"Deviances over two weeks","options":{"type":"LineChart","series":[{"dataOptions":{"type":"Deviance","checkerIds":[7,8,10,13,14,16,21,28,29,30,32,40,45,48],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":2592000},"displayOptions":{"label":"Critical Severity Deviances"}},{"dataOptions":{"type":"Deviance","checkerIds":[4,9,17,18,20,34,35,37,38,41,42,46,47],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":2592000},"displayOptions":{"label":"High Severity Deviances"}},{"dataOptions":{"type":"Deviance","checkerIds":[3,5,6,11,12,15,22,23,24,33,36,39,49],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":2592000},"displayOptions":{"label":"Medium Severity Deviances"}},{"dataOptions":{"type":"Deviance","checkerIds":[2,19,26,44],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":2592000},"displayOptions":{"label":"Low Severity Deviances"}}]}},{"id":1317,"posX":2,"posY":0,"height":2,"width":2,"title":"Global compliance score","options":{"type":"BigNumber","series":[{"dataOptions":{"type":"ComplianceScore","checkerIds":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,28,29,30,32,33,34,35,36,37,38,39,40,41,42,44,45,46,47],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":86400},"displayOptions":{"label":"Serie-1"}}]}},{"id":1318,"posX":0,"posY":2,"height":2,"width":2,"title":"Sensitive GPOs Compliance","options":{"type":"BigNumber","series":[{"dataOptions":{"type":"ComplianceScore","checkerIds":[28],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Serie-1"}}]}},{"id":1319,"posX":2,"posY":2,"height":2,"width":2,"title":"Deviances count","options":{"type":"BigNumber","series":[{"dataOptions":{"type":"Deviance","checkerIds":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,26,28,29,30,32,33,34,35,36,37,38,39,40,41,42,44,45,46,47],"directoryIds":[1,2],"reasonIds":[],"profileId":1,"duration":1296000},"displayOptions":{"label":"Serie-1"}}]}}]}}'
)


####### SkipCertCheck (For on-prem SEN) #########
if ( ($PSVersionTable.PSVersion.Major -lt 5) -or (($PSVersionTable.PSVersion.Major -eq 5) -and ($PSVersionTable.PSVersion.Minor -lt 2)) ) #check if PS is older than 5.2
{ 
    write-verbose "Old PowerShell version detected. Less than 5.2"

    if (-not ([System.Management.Automation.PSTypeName]'TrustAllCertsPolicy').Type)
    {
add-type @"
    using System.Net;
    using System.Security.Cryptography.X509Certificates;
    public class TrustAllCertsPolicy : ICertificatePolicy {
        public bool CheckValidationResult(
            ServicePoint srvPoint, X509Certificate certificate,
            WebRequest request, int certificateProblem) {
            return true;
        }
    }
"@
    }

    $AllProtocols = [System.Net.SecurityProtocolType]'Ssl3,Tls,Tls11,Tls12'
    [System.Net.ServicePointManager]::SecurityProtocol = $AllProtocols
    [System.Net.ServicePointManager]::CertificatePolicy = New-Object TrustAllCertsPolicy
}
else {
    $SCC=$true
}
##############################

$headers=@{}
$headers.Add("Accept", "application/json")
$headers.Add("x-api-key", $apikey)
$headers.Add("Content-Type", "application/json")

if ($RemoveExisting -eq $true) {
    # Get Existing Dashboards
    $dashboards_WebRequest = Invoke-WebRequest -Uri ($protocol+'://'+$server+'/api/dashboards') -Method GET -Headers $headers

    if ($dashboards_WebRequest.StatusDescription -ne 'OK') {
        Throw ("An error has occurred while fetching dashboards list. StatusDescription: "+$dashboards_WebRequest.StatusDescription)
    }

    $dashboards_JSON = ($dashboards_WebRequest.Content | ConvertFrom-Json)

    #------ Delete dashboards ------
    foreach( $dash in $dashboards_JSON ) { 
        $del_WebRequest = Invoke-WebRequest -Uri ($protocol+'://'+$server+'/api/dashboards/'+$dash.id) -Method DELETE -Headers $headers
        if ($del_WebRequest.StatusDescription -ne 'NoContent') {
            Throw ("An error has occurred while fetching dashboards list. StatusDescription: "+$del_WebRequest.StatusDescription)
        }
    }
}

if ($DashboardsPath -ne "") { #External path specified, use external templates instead of the built-in ones.
    if ((Get-Item $DashboardsPath).PSIsContainer -eq $True) {
        $templates=[System.Collections.ArrayList]@() #Zero out built-in templates array to fill it with new content
        Get-ChildItem $DashboardsPath -Filter *.json | Foreach-Object {
            #Write-Host (".Reading file: "+$_.FullName) 
            $t = Get-Content $_.FullName -Raw 
            $t_PSObj = (ConvertFrom-Json $t | ConvertTo-Json -Depth 100 -Compress) #remove spaces and carriage returns (causes powershell to go crazy)
            #$t_bytes = [System.Text.Encoding]::Unicode.GetBytes($t_PSObj)
            #$t_b64 = [System.Convert]::ToBase64String($t_bytes)
            #$templates.Add($t_b64) | Out-Null
            $templates.Add($t_PSObj) | Out-Null
        }
        Write-Host "--------------"
    }
    else {
        Write-Host "Error: Wrong Path specified."
    }
}

# Get list of directories (domains)
$directoryIds_req = Invoke-WebRequest -Uri ($protocol+'://'+$server+'/api/directories') -Method GET -Headers $headers -ContentType 'application/json'
$directoryIds = @()
$directoryIds += ($directoryIds_req.Content | convertfrom-json).id
if ($null -eq $directoryIds[0]) { 
    Write-Output "No Domains are currently configured, defaulting to ID: 1"
    $directoryIds = @(); 
    $directoryIds += 1 
}

# Loop templates
Foreach ($t in $templates) {
    #$t_bytes = [System.Convert]::FromBase64String($t)
    #$t_jsonString = [System.Text.Encoding]::UTF8.GetString($t_bytes)
    #$template=($t_jsonString | ConvertFrom-Json)
    $template=($t | ConvertFrom-Json)
    
    if ($template.name -eq "") {
        Throw ("An error has occurred converting a template file into a PSObject: $t_jsonString")
    }

    # Update widget options directoryIds based on found domains.
    $template.widget.value.options.series.dataoptions | ForEach-Object { $_.directoryIds = $directoryIds }

    Write-Host ("> Loading Template: " + $template.name)

    $DashboardInfo=($template | Select-Object name,order | ConvertTo-Json -Compress -Depth 100)
    Write-Verbose ("Dashboard Info: "+$DashboardInfo)

    #Find Existing Dashboard

    # Create a new Dashboard
    $Arguments= @{
        Uri=($protocol+'://'+$server+'/api/dashboards')
        Method='POST'
        Headers=$headers
        ContentType='application/json'
        Body=$DashboardInfo
    }
    if ($SCC) {$Arguments.Add('SkipCertificateCheck',$true)}
    $r1 = & Invoke-WebRequest @Arguments

    if ($r1.StatusDescription -ne 'created') {
        Throw ("An error has occurred. StatusDescription: "+$r1.StatusDescription)
    }

    $dashboardid = ($r1.Content | ConvertFrom-Json).id
    $dashboardname = ($r1.Content | ConvertFrom-Json).name
    Write-Host "+Created a new dashboard (name: $dashboardname , id: $dashboardid)"

    # List template widgets
    foreach ($widget in $template.widget.value)
    {
        Write-Host "----"

        # Load widgets one at a time into var
        Write-Verbose ("Loading Widget (title:"+$widget.title+", WdgFile-ID:"+$widget.id+")")
        $WidgetInfo=($widget | Select-Object -Property * -ExcludeProperty id, options | ConvertTo-Json -Depth 100 -Compress)

        #Import widget to Server
        # Write-Debug "Invoking WebRequest: ("+$protocol+"://"+$server+"/api/dashboards/"+$dashboardid+"/widgets)"
        $Arguments= @{
            Uri=($protocol+'://'+$server+'/api/dashboards/'+$dashboardid+'/widgets')
            Method='POST'
            Headers=$headers
            ContentType='application/json'
            Body=$WidgetInfo
        }
        if ($SCC) {$Arguments.Add('SkipCertificateCheck',$true)}
        $r2 = & Invoke-WebRequest @Arguments

        $WidgetID = ($r2.Content | ConvertFrom-Json).id
        Write-Host ("++Widget (title:"+$widget.title+", WidgetID:"+$WidgetID+") imported to Dashboard (name: "+$dashboardname+" , id: "+$dashboardid+")!")

        if ($r2.StatusDescription -ne 'created') {
            Throw ("An error has occurred. StatusDescription: "+$r2.StatusDescription)
        }

        foreach ($widgetopt in $widget.options)
        {
            # Load widget options
            $WidgetOptionsInfo = ($widgetopt | ConvertTo-Json -Depth 100 -Compress)
            # Write-Host $WidgetOptionsInfo

            # Import widget options
            Write-Verbose ($widgetopt | ConvertTo-Json -Depth 100 -Compress)

            $Arguments= @{
                Uri=($protocol+'://'+$server+'//api/dashboards/'+$dashboardid+'/widgets/'+$WidgetID+'/options')
                Method='PUT'
                Headers=$headers
                ContentType='application/json'
                Body=$WidgetOptionsInfo
            }
            if ($SCC) {$Arguments.Add('SkipCertificateCheck',$true)}
            $r3 = & Invoke-WebRequest @Arguments

            #Status returns 204 by default
            if ($r3.StatusDescription -ne 'NoContent' -and $r3.StatusDescription -ne 'No Content') {
                Throw ("An error has occurred while importing widget options.")
            }

            Write-Host ("+++Imported Widget Options.")
        }
    }
    Write-Host "---------------------------------------"
}
Write-Host "-------------------- ALL DONE -------------------"